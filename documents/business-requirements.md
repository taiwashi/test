# 映画館の窓口業務要件定義書

## 機能一覧
1. 映画一覧の提示
2. 映画の時間枠の表示
3. 空いている座席の提示
4. 座席予約の確定
5. レイトショー割引情報の提供

## 機能ごとの要件

### 1. 映画一覧の提示
- 現在上映中の映画の一覧を取得し、ユーザーに提示する。
- 映画名の補正機能を提供し、ユーザーが曖昧な指定をした場合でも正確な映画を特定できる。
- 映画の内容や評価を表示し、ユーザーに推薦する機能を含む。

### 2. 映画の時間枠の表示
- ユーザーが選択した映画の上映時間枠を取得し、提示する。
- 時間枠の選択機能を提供する。

### 3. 空いている座席の提示
- 映画と時間枠が確定した後、その枠で空いている座席を取得し、提示する。
- 複数の座席を選択できる機能を提供する。
- **追加要件**: 2席以上を選択した場合、連続した座席を自動的に選択する機能を提供する。

### 4. 座席予約の確定
- ユーザーが選択した座席の予約を確定する。
- 予約が確定したら、ユーザーに予約が確定した旨を通知する。
- **制限**: 1人あたり最大4席まで予約可能とする。

### 5. レイトショー割引情報の提供
- 映画の上映時間が21時以降の場合、レイトショー割引が適用されることをユーザーに通知する。
- 割引情報を映画の時間枠表示機能に統合し、該当する時間枠に割引情報を明示する。

## データ構造

### 映画情報
- title: 映画のタイトル (例: "インセプション")
- description: 映画の説明 (例: "夢の中でのスパイ活動を描いたサスペンス映画")
- rating: 映画の評価スコア (例: 4.5)
- cast: 出演者のリスト (例: ["レオナルド・ディカプリオ", "ジョセフ・ゴードン＝レヴィット", "エレン・ペイジ"])

### 時間枠情報
- schedule_id: 一意の識別子 (例: "SCH67890")
- movie_title: 関連する映画のタイトル (例: "インセプション")
- start_time: 上映開始時刻 (例: "2025-07-11T14:00:00Z")
- end_time: 上映終了時刻 (例: "2025-07-11T16:30:00Z")

### 座席情報
- seat_id: 一意の識別子 (例: "SEAT001")
- schedule_id: 関連する時間枠の識別子 (例: "SCH67890")
- row: 座席の行番号 (例: 5)
- column: 座席の列番号 (例: 8)
- status: 空き/予約済み (例: "空き")
- total_seats: 全体の座席数 (例: 30)

### 予約情報
- reservation_id: 一意の識別子 (例: "RES54321")
- user_id: 予約を行ったユーザーの識別子 (例: "USER123")
- seat_positions: 予約された座席の位置情報 (例: [{"row": 5, "column": 8}, {"row": 5, "column": 9}])
- reservation_time: 予約が行われた日時 (例: "2025-07-10T10:00:00Z")

### 割引情報
- discount_type: 割引の種類 (例: "レイトショー")
- applicable_time: 割引が適用される時間帯 (例: "21:00以降")
- discount_rate: 割引率または割引額 (例: "20%")

## データリレーション

1. **映画情報と時間枠情報**
   - 映画情報の `title` は時間枠情報の `movie_title` とリレーションを持つ。
   - 1つの映画は複数の時間枠を持つことができる。

2. **時間枠情報と座席情報**
   - 時間枠情報の `schedule_id` は座席情報の `schedule_id` とリレーションを持つ。
   - 1つの時間枠に複数の座席が関連付けられる。

3. **座席情報と予約情報**
   - 座席情報の `seat_id` は予約情報の `seat_positions` 内の座席位置とリレーションを持つ。
   - 1つの予約は複数の座席を含むことができる。

4. **割引情報と時間枠情報**
   - 割引情報の `applicable_time` は時間枠情報の `start_time` とリレーションを持つ。
   - 時間枠が割引条件を満たす場合、割引が適用される。